From ac5295b2988c16593f1423bb2f4308f9a6d62117 Mon Sep 17 00:00:00 2001
From: Heinz Wrobel <Heinz.Wrobel@nxp.com>
Date: Wed, 14 Nov 2018 11:25:00 +0100
Subject: [PATCH] qemu: linux-user strace is now more comprehensive about
 signals and functions

---
 linux-user/strace.c    |  2 ++
 linux-user/strace.list | 12 ++++++------
 2 files changed, 8 insertions(+), 6 deletions(-)

diff --git a/linux-user/strace.c b/linux-user/strace.c
index f0b1140..2ff6295 100644
--- a/linux-user/strace.c
+++ b/linux-user/strace.c
@@ -144,8 +144,10 @@ print_signal(abi_ulong arg, int last)
     case TARGET_SIGCHLD: signal_name = "SIGCHLD"; break;
     case TARGET_SIGCONT: signal_name = "SIGCONT"; break;
     case TARGET_SIGSTOP: signal_name = "SIGSTOP"; break;
+    case TARGET_SIGTSTP: signal_name = "SIGTSTP"; break;
     case TARGET_SIGTTIN: signal_name = "SIGTTIN"; break;
     case TARGET_SIGTTOU: signal_name = "SIGTTOU"; break;
+    case TARGET_SIGWINCH: signal_name = "SIGWINCH"; break;
     }
     if (signal_name == NULL) {
         print_raw_param("%ld", arg, last);
diff --git a/linux-user/strace.list b/linux-user/strace.list
index 3e99d80..e6d95a1 100644
--- a/linux-user/strace.list
+++ b/linux-user/strace.list
@@ -275,10 +275,10 @@
 { TARGET_NR_getcwd, "getcwd" , "%s(%p,%d)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_getdents
-{ TARGET_NR_getdents, "getdents" , NULL, NULL, NULL },
+{ TARGET_NR_getdents, "getdents" , "%s(%d,%#x,%d)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_getdents64
-{ TARGET_NR_getdents64, "getdents64" , NULL, NULL, NULL },
+{ TARGET_NR_getdents64, "getdents64" , "%s(%d,%#x,%d)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_getdomainname
 { TARGET_NR_getdomainname, "getdomainname" , NULL, NULL, NULL },
@@ -387,7 +387,7 @@
 { TARGET_NR_gettid, "gettid" , "%s()", NULL, NULL },
 #endif
 #ifdef TARGET_NR_gettimeofday
-{ TARGET_NR_gettimeofday, "gettimeofday" , NULL, NULL, NULL },
+{ TARGET_NR_gettimeofday, "gettimeofday" , "%s(%#x,%#x)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_getuid
 { TARGET_NR_getuid, "getuid" , "%s()", NULL, NULL },
@@ -513,7 +513,7 @@
 { TARGET_NR_lremovexattr, "lremovexattr" , NULL, NULL, NULL },
 #endif
 #ifdef TARGET_NR_lseek
-{ TARGET_NR_lseek, "lseek" , NULL, NULL, NULL },
+{ TARGET_NR_lseek, "lseek" , "%s(%d,%d,%d)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_lsetxattr
 { TARGET_NR_lsetxattr, "lsetxattr" , NULL, NULL, NULL },
@@ -1059,7 +1059,7 @@
 { TARGET_NR_profil, "profil" , NULL, NULL, NULL },
 #endif
 #ifdef TARGET_NR_pselect6
-{ TARGET_NR_pselect6, "pselect6" , NULL, NULL, NULL },
+{ TARGET_NR_pselect6, "pselect6" , "%s(%d,%#x,%#x,%#x,%#x,%#x)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_ptrace
 { TARGET_NR_ptrace, "ptrace" , NULL, NULL, NULL },
@@ -1633,7 +1633,7 @@
 { TARGET_NR_vserver, "vserver" , NULL, NULL, NULL },
 #endif
 #ifdef TARGET_NR_wait4
-{ TARGET_NR_wait4, "wait4" , NULL, NULL, NULL },
+{ TARGET_NR_wait4, "wait4" , "%s(%d,%#x,%d,%#x)", NULL, NULL },
 #endif
 #ifdef TARGET_NR_waitid
 { TARGET_NR_waitid, "waitid" , "%s(%#x,%d,%p,%#x)", NULL, NULL },
-- 
1.8.3.1

