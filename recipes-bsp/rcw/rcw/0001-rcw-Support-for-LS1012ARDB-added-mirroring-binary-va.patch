From 7256b86bd89c8e589d1a61c0b5e92e4b754b0da3 Mon Sep 17 00:00:00 2001
From: nxa15299 <Heinz.Wrobel@nxp.com>
Date: Tue, 16 Jan 2018 08:59:48 +0100
Subject: [PATCH] rcw: Support for LS1012ARDB added, mirroring binary values  in
 LSDK rocko as found in Jan 2018 in public

Signed-off-by: nxa15299 <Heinz.Wrobel@nxp.com>
---
 ls1012ardb/Makefile                                |   1 +
 ls1012ardb/README                                  |   3 +-
 .../PBL_0x35_0x08_800_250_1000_default.rcw         |  40 +++++++++++++++
 .../PBL_0x35_0x08_800_250_1000_sben.rcw            |  43 ++++++++++++++++
 .../PBL_0x35_0x08_800_250_1000_default.rcw         |  40 +++++++++++++++
 .../PBL_0x35_0x08_800_250_1000_sben.rcw            |  42 +++++++++++++++
 ls1012ardb/a010554.rcw                             |   7 +++
 ls1012ardb/bootlocptr_qspi_p1.rcw                  |   7 +++
 ls1012ardb/bootlocptr_qspi_p2.rcw                  |   6 +++
 ls1012ardb/clkpcsr.rcw                             |   6 +++
 ls1012ardb/enablepcieepcfg.rcw                     |   7 +++
 ls1012ardb/ls1012a.rcwi                            |  57 +++++++++++++++++++++
 ls1012ardb/qspi_cfg.rcw                            |   6 +++
 ls1012ardb/qspi_endianess.rcw                      |   6 +++
 ls1012ardb/sata6gbaud.rcw                          |   6 +++
 ls1012ardb/scratchrw1_esbc.rcw                     |   6 +++
 ls1012ardb/usb_phy_ctrl.rcw                        |   6 +++
 21 files changed, 288 insertions(+), 1 deletion(-)
 create mode 100644 ls1012ardb/Makefile
 create mode 100644 ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
 create mode 100644 ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
 create mode 100644 ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
 create mode 100644 ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
 create mode 100644 ls1012ardb/a010554.rcw
 create mode 100644 ls1012ardb/bootlocptr_qspi_p1.rcw
 create mode 100644 ls1012ardb/bootlocptr_qspi_p2.rcw
 create mode 100644 ls1012ardb/clkpcsr.rcw
 create mode 100644 ls1012ardb/enablepcieepcfg.rcw
 create mode 100644 ls1012ardb/ls1012a.rcwi
 create mode 100644 ls1012ardb/qspi_cfg.rcw
 create mode 100644 ls1012ardb/qspi_endianess.rcw
 create mode 100644 ls1012ardb/sata6gbaud.rcw
 create mode 100644 ls1012ardb/scratchrw1_esbc.rcw
 create mode 100644 ls1012ardb/usb_phy_ctrl.rcw

diff --git a/ls1012ardb/Makefile b/ls1012ardb/Makefile
new file mode 100644
index 0000000..f77e46b
--- /dev/null
+++ b/ls1012ardb/Makefile
@@ -0,0 +1 @@
+include ../Makefile.inc
diff --git a/ls1012ardb/README b/ls1012ardb/README
index 006da6e..807997a 100644
--- a/ls1012ardb/README
+++ b/ls1012ardb/README
@@ -13,7 +13,8 @@ e = What is available in SerDes1 Lane2
 
 For the Slots (c..j):
  'N' is NULL, not available/not used
- 'P' is PCIe
+ 'P' is PCIe RC
+ 'E' is PCIe EP
  'S' is SGMII
  'H' is SATA
 
diff --git a/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_default.rcw b/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
new file mode 100644
index 0000000..7c41b41
--- /dev/null
+++ b/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
@@ -0,0 +1,40 @@
+#include <ls1012a.rcwi>
+
+SYS_PLL_RAT=4
+CGA_PLL1_RAT=8
+SRDS_PRTCL_S1=0x3508
+SRDS_PLL_REF_CLK_SEL_S1=3
+RESERVED188_1=1
+SRDS_INT_REFCLK=1
+PBI_SRC=4
+SYS_PLL_SPD=1
+CGA_PLL1_SPD=1
+EC1_BASE=1
+UART1_BASE=1
+SDHC1_BASE=1
+SDHC2_BASE_DAT321=1
+SDHC2_BASE_BASE=1
+UART2_BASE_DATA=1
+EMI1_BASE=1
+CLK_OUT_BASE=1
+SDHC1_CD=1
+SDHC1_WP=1
+QSPI_IIC2=3
+USB1_DRVVBUS_BASE=1
+USB1_PWRFAULT_BASE=1
+SDHC1_VSEL=1
+EVDD_SEL=2
+IIC1_BASE=1
+SYSCLK_FREQ=0x258
+HOST_AGT_PEX=1
+
+#include <bootlocptr_qspi_p1.rcw>
+#include <qspi_cfg.rcw>
+#include <bootlocptr_qspi_p2.rcw>
+#include <usb_phy_ctrl.rcw>
+#include <sata6gbaud.rcw>
+#include <a010554.rcw>
+#include <clkpcsr.rcw>
+#include <qspi_endianess.rcw>
+/* CRC and Stop command (CRC 0x15c98e05)*/
+
diff --git a/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw b/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
new file mode 100644
index 0000000..4d010ab
--- /dev/null
+++ b/ls1012ardb/R_SENH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
@@ -0,0 +1,43 @@
+#include <ls1012a.rcwi>
+
+SYS_PLL_RAT=4
+CGA_PLL1_RAT=8
+SRDS_PRTCL_S1=0x3508
+SRDS_PLL_REF_CLK_SEL_S1=3
+RESERVED188_1=1
+SRDS_INT_REFCLK=1
+PBI_SRC=4
+BOOT_HO=1
+SB_EN=1
+SYS_PLL_SPD=1
+CGA_PLL1_SPD=1
+EC1_BASE=1
+UART1_BASE=1
+SDHC1_BASE=1
+SDHC2_BASE_DAT321=1
+SDHC2_BASE_BASE=1
+UART2_BASE_DATA=1
+EMI1_BASE=1
+CLK_OUT_BASE=1
+SDHC1_CD=1
+SDHC1_WP=1
+QSPI_IIC2=3
+USB1_DRVVBUS_BASE=1
+USB1_PWRFAULT_BASE=1
+SDHC1_VSEL=1
+EVDD_SEL=2
+IIC1_BASE=1
+SYSCLK_FREQ=0x258
+HOST_AGT_PEX=1
+
+#include <bootlocptr_qspi_p1.rcw>
+#include <qspi_cfg.rcw>
+#include <bootlocptr_qspi_p2.rcw>
+#include <usb_phy_ctrl.rcw>
+#include <sata6gbaud.rcw>
+#include <a010554.rcw>
+#include <clkpcsr.rcw>
+#include <scratchrw1_esbc.rcw>
+#include <qspi_endianess.rcw>
+/* CRC and Stop command (CRC 0xf4688703)*/
+
diff --git a/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_default.rcw b/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
new file mode 100644
index 0000000..4230ce8
--- /dev/null
+++ b/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_default.rcw
@@ -0,0 +1,40 @@
+#include <ls1012a.rcwi>
+
+SYS_PLL_RAT=4
+CGA_PLL1_RAT=8
+SRDS_PRTCL_S1=0x3508
+SRDS_PLL_REF_CLK_SEL_S1=3
+RESERVED188_1=1
+SRDS_INT_REFCLK=1
+PBI_SRC=4
+SYS_PLL_SPD=1
+CGA_PLL1_SPD=1
+EC1_BASE=1
+UART1_BASE=1
+SDHC1_BASE=1
+SDHC2_BASE_DAT321=1
+SDHC2_BASE_BASE=1
+UART2_BASE_DATA=1
+EMI1_BASE=1
+CLK_OUT_BASE=1
+SDHC1_CD=1
+SDHC1_WP=1
+QSPI_IIC2=3
+USB1_DRVVBUS_BASE=1
+USB1_PWRFAULT_BASE=1
+SDHC1_VSEL=1
+EVDD_SEL=2
+IIC1_BASE=1
+SYSCLK_FREQ=0x258
+
+#include <bootlocptr_qspi_p1.rcw>
+#include <qspi_cfg.rcw>
+#include <bootlocptr_qspi_p2.rcw>
+#include <usb_phy_ctrl.rcw>
+#include <sata6gbaud.rcw>
+#include <a010554.rcw>
+#include <clkpcsr.rcw>
+#include <enablepcieepcfg.rcw>
+#include <qspi_endianess.rcw>
+/* CRC and Stop command (CRC 0x15c98e05)*/
+
diff --git a/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw b/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
new file mode 100644
index 0000000..e05ff49
--- /dev/null
+++ b/ls1012ardb/R_SPNH_3508/PBL_0x35_0x08_800_250_1000_sben.rcw
@@ -0,0 +1,42 @@
+#include <ls1012a.rcwi>
+
+SYS_PLL_RAT=4
+CGA_PLL1_RAT=8
+SRDS_PRTCL_S1=0x3508
+SRDS_PLL_REF_CLK_SEL_S1=3
+RESERVED188_1=1
+SRDS_INT_REFCLK=1
+PBI_SRC=4
+BOOT_HO=1
+SB_EN=1
+SYS_PLL_SPD=1
+CGA_PLL1_SPD=1
+EC1_BASE=1
+UART1_BASE=1
+SDHC1_BASE=1
+SDHC2_BASE_DAT321=1
+SDHC2_BASE_BASE=1
+UART2_BASE_DATA=1
+EMI1_BASE=1
+CLK_OUT_BASE=1
+SDHC1_CD=1
+SDHC1_WP=1
+QSPI_IIC2=3
+USB1_DRVVBUS_BASE=1
+USB1_PWRFAULT_BASE=1
+SDHC1_VSEL=1
+EVDD_SEL=2
+IIC1_BASE=1
+SYSCLK_FREQ=0x258
+
+#include <bootlocptr_qspi_p1.rcw>
+#include <bootlocptr_qspi_p2.rcw>
+#include <usb_phy_ctrl.rcw>
+#include <sata6gbaud.rcw>
+#include <a010554.rcw>
+#include <clkpcsr.rcw>
+#include <enablepcieepcfg.rcw>
+#include <scratchrw1_esbc.rcw>
+#include <qspi_endianess.rcw>
+/* CRC and Stop command (CRC 0xa194d035)*/
+
diff --git a/ls1012ardb/a010554.rcw b/ls1012ardb/a010554.rcw
new file mode 100644
index 0000000..cbb0b38
--- /dev/null
+++ b/ls1012ardb/a010554.rcw
@@ -0,0 +1,7 @@
+/*
+ * Errata workaround for
+ * A-010554: SATA controller might fail to detect some hard drives
+ */
+.pbi
+write 0x00ea1300,0x80104e20
+.end
diff --git a/ls1012ardb/bootlocptr_qspi_p1.rcw b/ls1012ardb/bootlocptr_qspi_p1.rcw
new file mode 100644
index 0000000..33352f3
--- /dev/null
+++ b/ls1012ardb/bootlocptr_qspi_p1.rcw
@@ -0,0 +1,7 @@
+/*
+ * Booting from QSPI, Part 1
+ */
+.pbi
+/* BOOTLOCPTR */
+write 0x00570604,0x40100000
+.end
diff --git a/ls1012ardb/bootlocptr_qspi_p2.rcw b/ls1012ardb/bootlocptr_qspi_p2.rcw
new file mode 100644
index 0000000..902229b
--- /dev/null
+++ b/ls1012ardb/bootlocptr_qspi_p2.rcw
@@ -0,0 +1,6 @@
+/*
+ * Booting from QSPI, Part 2
+ */
+.pbi
+write 0x00570600,0x00000000
+.end
diff --git a/ls1012ardb/clkpcsr.rcw b/ls1012ardb/clkpcsr.rcw
new file mode 100644
index 0000000..de5b431
--- /dev/null
+++ b/ls1012ardb/clkpcsr.rcw
@@ -0,0 +1,6 @@
+/*
+ * Update CLKPCSR to enable CLK_OUT with Divide-by-1
+ */
+.pbi
+write 0x00ee1a00,0x00010000
+.end
diff --git a/ls1012ardb/enablepcieepcfg.rcw b/ls1012ardb/enablepcieepcfg.rcw
new file mode 100644
index 0000000..f57beb9
--- /dev/null
+++ b/ls1012ardb/enablepcieepcfg.rcw
@@ -0,0 +1,7 @@
+/*
+ * Set PEX_PF0_CONFIG[CFG_READY]
+ */
+.pbi
+write 0x00570158,0x00000200
+awrite 0x004c0014,0x00000001
+.end
diff --git a/ls1012ardb/ls1012a.rcwi b/ls1012ardb/ls1012a.rcwi
new file mode 100644
index 0000000..293be4f
--- /dev/null
+++ b/ls1012ardb/ls1012a.rcwi
@@ -0,0 +1,57 @@
+%size=512
+%pbiformat=1
+%sysaddr=0x01ee0100
+%pbladdr=0x01610000
+%littleendian64b=1
+%dont64bswapcrc=1
+
+SYS_PLL_CFG[0:1]
+SYS_PLL_RAT[2:6]
+CGA_PLL1_CFG[24:25]
+CGA_PLL1_RAT[26:31]
+SRDS_PRTCL_S1[128:143]
+SRDS_PLL_REF_CLK_SEL_S1[160:161]
+RESERVED166_167_1[166:167]
+SRDS_PLL_PD_S1[168:169]
+RESERVED188_1[188]
+SRDS_INT_REFCLK[189]
+PBI_SRC[192:195]
+BOOT_HO[201]
+SB_EN[202]
+SYS_PLL_SPD[242:243]
+CGA_PLL1_SPD[244]
+HOST_AGT_PEX[264]
+GP_INFO[288:319]
+SDHC2_EXT_CLK[254]
+SDHC2_EXT_CMD[355]
+SDHC2_EXT_DAT3[356]
+SDHC2_EXT_DAT2[357]
+SDHC2_EXT_DAT1[358]
+SDHC2_EXT_DAT0[359]
+EC1_EXT_SAI3[360:361]
+EC1_EXT_SAI4[362:363]
+EC1_EXT_SAI2_TX[364]
+EC1_EXT_SAI2_RX[365]
+EC1_BASE[366:367]
+UART1_BASE[368:369]
+UART2_BASE_FLOW[370:371]
+SDHC1_BASE[372:373]
+SDHC2_BASE_DAT321[374:375]
+SDHC2_BASE_BASE[376:377]
+UART2_BASE_DATA[378]
+EMI1_BASE[379]
+GPIO_FTM_EXTCLK_BASE[380:381]
+CLK_OUT_BASE[383]
+SDHC1_CD[419]
+SDHC1_WP[420]
+QSPI_DATA0_GPIO[421]
+QSPI_DATA1_GPIO[422:423]
+QSPI_IIC2[424:425]
+USB1_DRVVBUS_BASE[429:430]
+USB1_PWRFAULT_BASE[431:432]
+SDHC1_VSEL[434]
+EMI1_MODE[438]
+EVDD_SEL[439:440]
+IIC1_BASE[441:442]
+EMI1_CMODE[444]
+SYSCLK_FREQ[472:481]
diff --git a/ls1012ardb/qspi_cfg.rcw b/ls1012ardb/qspi_cfg.rcw
new file mode 100644
index 0000000..18dc5f3
--- /dev/null
+++ b/ls1012ardb/qspi_cfg.rcw
@@ -0,0 +1,6 @@
+/*
+ * Update QSPI clock configuration, Booting from QPSI, Part 3
+ */
+.pbi
+write 0x0057015c,0x50100000
+.end
diff --git a/ls1012ardb/qspi_endianess.rcw b/ls1012ardb/qspi_endianess.rcw
new file mode 100644
index 0000000..fb10ec8
--- /dev/null
+++ b/ls1012ardb/qspi_endianess.rcw
@@ -0,0 +1,6 @@
+/*
+ * Update QSPI endianess to 64b LE
+ */
+.pbi
+write 0x00550000,0x000f400c
+.end
diff --git a/ls1012ardb/sata6gbaud.rcw b/ls1012ardb/sata6gbaud.rcw
new file mode 100644
index 0000000..f18e98a
--- /dev/null
+++ b/ls1012ardb/sata6gbaud.rcw
@@ -0,0 +1,6 @@
+/*
+ * Update SATA SerDes settings for 6Gbaud support
+ */
+.pbi
+write 0x00ea08dc,0x00502880
+.end
diff --git a/ls1012ardb/scratchrw1_esbc.rcw b/ls1012ardb/scratchrw1_esbc.rcw
new file mode 100644
index 0000000..1674e3f
--- /dev/null
+++ b/ls1012ardb/scratchrw1_esbc.rcw
@@ -0,0 +1,6 @@
+/*
+ * Set ESBC pointer for secure boot
+ */
+.pbi
+write 0x00ee0200,0x406c0000
+.end
diff --git a/ls1012ardb/usb_phy_ctrl.rcw b/ls1012ardb/usb_phy_ctrl.rcw
new file mode 100644
index 0000000..574b80b
--- /dev/null
+++ b/ls1012ardb/usb_phy_ctrl.rcw
@@ -0,0 +1,6 @@
+/*
+ * Update USB PHY configuration
+ */
+.pbi
+write 0x00570418,0x0000009c
+.end
-- 
2.15.1

